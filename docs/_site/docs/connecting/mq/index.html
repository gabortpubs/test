<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.12.0 by Michael Rose
  Copyright 2013-2018 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE.txt
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Connecting to IBM MQ - IBM Event Streams</title>
<meta name="description" content="Connecting to MQ.">



<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="IBM Event Streams">
<meta property="og:title" content="Connecting to IBM MQ">
<meta property="og:url" content="http://localhost:4000/mhub/qp-docs/docs/connecting/mq/">


  <meta property="og:description" content="Connecting to MQ.">







  <meta property="article:published_time" content="2018-09-09T10:14:16-04:00">



  <meta property="article:modified_time" content="2018-07-19T11:31:38-04:00">



  

  


<link rel="canonical" href="http://localhost:4000/mhub/qp-docs/docs/connecting/mq/">







  <script type="application/ld+json">
    {
      "@context": "http://schema.org",
      "@type": "Person",
      "name": "IBM",
      "url": "http://localhost:4000/mhub/qp-docs",
      "sameAs": null
    }
  </script>







<!-- end _includes/seo.html -->


<link href="/mhub/qp-docs/feed.xml" type="application/atom+xml" rel="alternate" title="IBM Event Streams Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/mhub/qp-docs/assets/css/main.css">

<!--[if lte IE 9]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->


    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single">

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    <div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        <a class="site-title" href="/mhub/qp-docs/">IBM Event Streams</a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/mhub/qp-docs/docs/about/overview/" >Documentation</a>
            </li><li class="masthead__menu-item">
              <a href="/mhub/qp-docs/support/" >Support</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <svg class="icon" width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.99 16">
            <path d="M15.5,13.12L13.19,10.8a1.69,1.69,0,0,0-1.28-.55l-0.06-.06A6.5,6.5,0,0,0,5.77,0,6.5,6.5,0,0,0,2.46,11.59a6.47,6.47,0,0,0,7.74.26l0.05,0.05a1.65,1.65,0,0,0,.5,1.24l2.38,2.38A1.68,1.68,0,0,0,15.5,13.12ZM6.4,2A4.41,4.41,0,1,1,2,6.4,4.43,4.43,0,0,1,6.4,2Z" transform="translate(-.01)"></path>
          </svg>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle Menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  
  
    
      
      
      
    
    
      

<nav class="nav__list">
  
  <input id="ac-toc" name="accordion-toc" type="checkbox" />
  <label for="ac-toc">Toggle Menu</label>
  <ul class="nav__items">
    
      <li>
        
          
          

          <a href="/mhub/qp-docs/docs/about/overview/"><span class="nav__sub-title">About</span></a>
        

        
        <ul>
          
            
            

            
            

            <li><a href="/mhub/qp-docs/docs/about/overview/" class="">Introduction</a></li>
          
            
            

            
            

            <li><a href="/mhub/qp-docs/docs/about/key-concepts/" class="">Key concepts</a></li>
          
            
            

            
            

            <li><a href="/mhub/qp-docs/docs/about/producing-messages/" class="">Producing messages</a></li>
          
            
            

            
            

            <li><a href="/mhub/qp-docs/docs/about/consuming-messages/" class="">Consuming messages</a></li>
          
            
            

            
            

            <li><a href="/mhub/qp-docs/docs/about/partition-leadership/" class="">Partition leadership</a></li>
          
            
            

            
            

            <li><a href="/mhub/qp-docs/docs/about/accessibility/" class="">Accessibility</a></li>
          
            
            

            
            

            <li><a href="/mhub/qp-docs/docs/about/notices/" class="">Notices</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Installing</span>
        

        
        <ul>
          
            
            

            
            

            <li><a href="/mhub/qp-docs/docs/installing/prerequisites/" class="">Pre-requisites</a></li>
          
            
            

            
            

            <li><a href="/mhub/qp-docs/docs/installing/planning/" class="">Planning for installation</a></li>
          
            
            

            
            

            <li><a href="/mhub/qp-docs/docs/installing/downloading/" class="">Downloading</a></li>
          
            
            

            
            

            <li><a href="/mhub/qp-docs/docs/installing/installing/" class="">Installing</a></li>
          
            
            

            
            

            <li><a href="/mhub/qp-docs/docs/installing/configuring/" class="">Configuring</a></li>
          
            
            

            
            

            <li><a href="/mhub/qp-docs/docs/installing/migrating/" class="">Migrating to IBM Event Streams</a></li>
          
            
            

            
            

            <li><a href="/mhub/qp-docs/docs/installing/post-installation/" class="">Post-installation tasks</a></li>
          
            
            

            
            

            <li><a href="/mhub/qp-docs/docs/installing/uninstalling/" class="">Uninstalling</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Getting started</span>
        

        
        <ul>
          
            
            

            
            

            <li><a href="/mhub/qp-docs/docs/getting-started/logging-in/" class="">Logging in</a></li>
          
            
            

            
            

            <li><a href="/mhub/qp-docs/docs/getting-started/generating-starter-app/" class="">Generating a starter application</a></li>
          
            
            

            
            

            <li><a href="/mhub/qp-docs/docs/getting-started/testing-loads/" class="">Creating and testing message loads</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Security</span>
        

        
        <ul>
          
            
            

            
            

            <li><a href="/mhub/qp-docs/docs/security/users/" class="">Setting up users</a></li>
          
            
            

            
            

            <li><a href="/mhub/qp-docs/docs/security/encrypting-data/" class="">Encrypting your data</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Geo-replication</span>
        

        
        <ul>
          
            
            

            
            

            <li><a href="/mhub/qp-docs/docs/replication/about/" class="">About geo-replication</a></li>
          
            
            

            
            

            <li><a href="/mhub/qp-docs/docs/replication/planning/" class="">Planning for geo-replication</a></li>
          
            
            

            
            

            <li><a href="/mhub/qp-docs/docs/replication/setting-up/" class="">Setting up geo-replication</a></li>
          
            
            

            
            

            <li><a href="/mhub/qp-docs/docs/replication/health/" class="">Monitoring health of geo-replication</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Connecting to other systems</span>
        

        
        <ul>
          
            
            

            
            

            <li><a href="/mhub/qp-docs/docs/connecting/mq/" class="active">Connecting to IBM MQ</a></li>
          
            
            

            
            

            <li><a href="/mhub/qp-docs/docs/connecting/mq-source-reference/" class="">Reference for IBM MQ source connector</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Administering</span>
        

        
        <ul>
          
            
            

            
            

            <li><a href="/mhub/qp-docs/docs/administering/deployment-health/" class="">Monitoring deployment health</a></li>
          
            
            

            
            

            <li><a href="/mhub/qp-docs/docs/administering/cluster-health/" class="">Monitoring Kafka cluster health</a></li>
          
            
            

            
            

            <li><a href="/mhub/qp-docs/docs/administering/modifying-configs/" class="">Modifying configuration settings</a></li>
          
            
            

            
            

            <li><a href="/mhub/qp-docs/docs/administering/scaling/" class="">Scaling</a></li>
          
            
            

            
            

            <li><a href="/mhub/qp-docs/docs/administering/updating-dynamically/" class="">Updating dynamically</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          
          

          <a href="/mhub/qp-docs/docs/troubleshooting/intro/"><span class="nav__sub-title">Troubleshooting</span></a>
        

        
        <ul>
          
            
            

            
            

            <li><a href="/mhub/qp-docs/docs/troubleshooting/ui-error-firefox/" class="">UI error on Firefox</a></li>
          
        </ul>
        
      </li>
    
  </ul>
</nav>
    
  
  </div>


  <article class="page" itemscope itemtype="http://schema.org/CreativeWork">
    <meta itemprop="headline" content="Connecting to IBM MQ">
    <meta itemprop="description" content="Connecting to MQ.">
    <meta itemprop="datePublished" content="September 09, 2018">
    <meta itemprop="dateModified" content="July 19, 2018">

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">Connecting to IBM MQ
</h1>
          
        </header>
      

      <section class="page__content" itemprop="text">
        
          <aside class="sidebar__right ">
            <nav class="toc">
              <header><h4 class="nav__title"><i class="fas fa-file-alt"></i> On This Page</h4></header>
              <ul class="toc__menu">
  <li><a href="#when-to-use">When to use</a>
    <ul>
      <li><a href="#about-kafka-connect">About Kafka Connect</a></li>
    </ul>
  </li>
  <li><a href="#prerequisites">Prerequisites</a></li>
  <li><a href="#downloading">Downloading</a></li>
  <li><a href="#setting-up-the-queue-manager">Setting up the queue manager</a></li>
  <li><a href="#setting-up-apache-kafka">Setting up Apache Kafka</a></li>
  <li><a href="#configuring-the-connector">Configuring the connector</a></li>
  <li><a href="#running-the-connector">Running the connector</a></li>
  <li><a href="#stopping-apache-kafka">Stopping Apache Kafka</a></li>
</ul>
            </nav>
          </aside>
        
        <p>You can use the Kafka Connect source connector for IBM MQ to copy data from IBM MQ into IBM Event Streams or Apache Kafka. The connector copies messages from a source MQ queue to a target Kafka topic.</p>

<p>Follow these instructions to set up IBM MQ and Apache Kafka from scratch, and use the connector to transfer messages from IBM MQ to Kafka.</p>

<h2 id="when-to-use">When to use</h2>

<p>Many organizations use both IBM MQ and Apache Kafka for their messaging needs. Although they’re often used to solve different kinds of messaging problems, users often want to connect them together for various reasons. <strong>DRAFT COMMENT</strong>: <em>Can we provide an example or two of why they would do this? Just in a sentence.</em></p>

<p>The Kafka Connect source connector for IBM MQ is used to take messages from an MQ queue and transfer them to a Kafka topic.</p>

<h3 id="about-kafka-connect">About Kafka Connect</h3>

<p>When connecting Apache Kafka and other systems, the technology of choice is the <a href="https://kafka.apache.org/documentation/#connect">Kafka Connect framework</a>.</p>

<p>Kafka Connect connectors run inside a Java process called a worker. Kafka Connect can run in either standalone or distributed mode. Standalone mode is intended for testing and temporary connections between systems. Distributed mode is more appropriate for production use. These instructions are for standalone mode for ease of understanding.</p>

<p>When you run Kafka Connect with a standalone worker, there are two configuration files:</p>
<ul>
  <li>The worker configuration file contains the properties needed to connect to Kafka. This is where you provide the details for connecting to Kafka.</li>
  <li>The connector configuration file contains the properties needed for the connector. This is where you provide the details for connecting to IBM MQ.</li>
</ul>

<p>The simplest setup is to run only one connector in each standalone worker. Kafka Connect workers create a lot of messages and it’s simpler to read them if the messages from multiple connectors are not interleaved.</p>

<h2 id="prerequisites">Prerequisites</h2>

<p>The connector runs inside the Kafka Connect runtime, which is part of the Apache Kafka distribution. IBM Event Streams does not run connectors, so you need an Apache Kafka distribution to get the Kafka Connect runtime environment.</p>

<p>Ensure you have the following available:</p>

<ul>
  <li><a href="https://www.ibm.com/support/knowledgecenter/en/SSFKSJ_8.0.0/com.ibm.mq.helphome.v80.doc/WelcomePagev8r0.htm">IBM MQ</a> v8 or later installed. <strong>Note:</strong> These instructions are for IBM MQ v9 running on Linux&gt;. If you’re using a different version or platform, you might have to adjust some steps slightly.</li>
  <li>An <a href="http://kafka.apache.org/downloads">Apache Kafka</a> distribution for the Kafka Connect runtime environment. These instructions are for Apache Kafka 0.10.2.0 or later.</li>
  <li>The Kafka Connect source connector JAR you <a href="#downloading">download from IBM Event Streams UI</a>.</li>
  <li>Configuration information for connecting to your IBM MQ queue manager. You can use the sample connector properties file that you <a href="#downloading">download from the IBM Event Streams UI</a>.</li>
  <li>Configuration information for connecting to your IBM Event Streams or Apache Kafka cluster (IP address and port).</li>
</ul>

<h2 id="downloading">Downloading</h2>

<p>You can obtain the Kafka Connect source connector for IBM MQ as follows:</p>
<ol>
  <li>Log in to your IBM Event Streams UI.</li>
  <li>Click the <strong>Toolbox</strong> tab, and click <strong>Kafka Connect source connector for IBM MQ</strong>.</li>
  <li>Download both the <code class="highlighter-rouge">connector JAR</code> and the <code class="highlighter-rouge">sample connector properties</code> files from the page.</li>
</ol>

<p>Alternatively, you can clone the project from Github by going to <a href="https://github.com/ibm-messaging/kafka-connect-mq-source">this repository</a>, but in this case you will have to build the connector yourself (see instructions in README).</p>

<h2 id="setting-up-the-queue-manager">Setting up the queue manager</h2>

<p>These sample instructions set up a queue manager in IBM MQ that uses the local operating system to authenticate the user ID and password. The example uses the user ID <code class="highlighter-rouge">alice</code> and the password <code class="highlighter-rouge">passw0rd</code>.</p>

<ol>
  <li>Log in to IBM MQ as and administrator, and ensure the MQ commands are on the path.</li>
  <li>Create a queue manager with a TCP/IP listener on port 1414: <br /> <code class="highlighter-rouge">crtmqm -p 1414 MYQM</code></li>
  <li>Start the queue manager: <br /> <code class="highlighter-rouge">strmqm MYQM</code></li>
  <li>Start the <code class="highlighter-rouge">runmqsc</code> tool to configure the queue manager: <br /> <code class="highlighter-rouge">runmqsc MYQM</code></li>
  <li>In <code class="highlighter-rouge">runmqsc</code>, create a server-connection channel: <br /> <code class="highlighter-rouge">DEFINE CHANNEL(MYSVRCONN) CHLTYPE(SVRCONN)</code></li>
  <li>Set the channel authentication rules to accept connections requiring userid and password: <br />
    <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SET CHLAUTH<span class="o">(</span>MYSVRCONN<span class="o">)</span> TYPE<span class="o">(</span>BLOCKUSER<span class="o">)</span> USERLIST<span class="o">(</span><span class="s1">'nobody'</span><span class="o">)</span>
SET CHLAUTH<span class="o">(</span><span class="s1">'*'</span><span class="o">)</span> TYPE<span class="o">(</span>ADDRESSMAP<span class="o">)</span> ADDRESS<span class="o">(</span><span class="s1">'*'</span><span class="o">)</span> USERSRC<span class="o">(</span>NOACCESS<span class="o">)</span>
SET CHLAUTH<span class="o">(</span>MYSVRCONN<span class="o">)</span> TYPE<span class="o">(</span>ADDRESSMAP<span class="o">)</span> ADDRESS<span class="o">(</span><span class="s1">'*'</span><span class="o">)</span> USERSRC<span class="o">(</span>CHANNEL<span class="o">)</span> CHCKCLNT<span class="o">(</span>REQUIRED<span class="o">)</span>
</code></pre></div>    </div>
  </li>
  <li>Set the identity of the client connections based on the supplied context (the user ID): <br /> <code class="highlighter-rouge">ALTER AUTHINFO(SYSTEM.DEFAULT.AUTHINFO.IDPWOS) AUTHTYPE(IDPWOS) ADOPTCTX(YES)</code></li>
  <li>Refresh the connection authentication information: <br /> <code class="highlighter-rouge">REFRESH SECURITY TYPE(CONNAUTH)</code></li>
  <li>Create a pair of queues for the Kafka Connect connectors to use: <br />
    <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>DEFINE QLOCAL<span class="o">(</span>MYQSOURCE<span class="o">)</span>
DEFINE QLOCAL<span class="o">(</span>MYQSINK<span class="o">)</span>
</code></pre></div>    </div>
  </li>
  <li>Authorize the user ID <code class="highlighter-rouge">alice</code> to connect to and inquire the queue manager: <br /> <code class="highlighter-rouge">SET AUTHREC OBJTYPE(QMGR) PRINCIPAL('alice') AUTHADD(CONNECT,INQ)</code></li>
  <li>Authorize the user ID <code class="highlighter-rouge">alice</code> to use the queues: <br />
    <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SET AUTHREC PROFILE<span class="o">(</span>MYQSOURCE<span class="o">)</span> OBJTYPE<span class="o">(</span>QUEUE<span class="o">)</span> PRINCIPAL<span class="o">(</span><span class="s1">'alice'</span><span class="o">)</span> AUTHADD<span class="o">(</span>ALLMQI<span class="o">)</span>
SET AUTHREC PROFILE<span class="o">(</span>MYQSINK<span class="o">)</span> OBJTYPE<span class="o">(</span>QUEUE<span class="o">)</span> PRINCIPAL<span class="o">(</span><span class="s1">'alice'</span><span class="o">)</span> AUTHADD<span class="o">(</span>ALLMQI<span class="o">)</span>
</code></pre></div>    </div>
  </li>
  <li>Stop <code class="highlighter-rouge">runmqsc</code> tool by typing <code class="highlighter-rouge">END</code>.</li>
</ol>

<p>The queue manager is now ready to accept connection from Kafka Connect connectors.</p>

<h2 id="setting-up-apache-kafka">Setting up Apache Kafka</h2>

<p>If you do not already have Apache Kafka, you can download it from <a href="http://kafka.apache.org/downloads">here</a>. Ensure you have the prerequisites installed, such as Java.</p>

<p>Download the latest <code class="highlighter-rouge">.tgz</code> file (for example, <code class="highlighter-rouge">kafka_2.11-1.0.0.tgz</code>) and extract it. The top-level directory of the extracted <code class="highlighter-rouge">.tgz</code> file is the Kafka root directory. It contains several directories including <code class="highlighter-rouge">/bin</code> for the Kafka executables and <code class="highlighter-rouge">/config</code> for the configuration files.</p>

<p>To run a minimal Kafka cluster, you need to start up several components.</p>

<p><strong>Tip:</strong> For clarity, run each component in a separate terminal window, starting each in the Kafka root directory.</p>

<ol>
  <li>Open a terminal window and change to the Kafka root directory. Start a ZooKeeper server: <br /> <code class="highlighter-rouge">bin/zookeeper-server-start.sh config/zookeeper.properties</code> <br /> When the ZooKeeper server is up and running, it prints a message similar to the following: <br /> <code class="highlighter-rouge">INFO binding to port 0.0.0.0/0.0.0.0:2181</code></li>
  <li>Open another terminal and start a Kafka server: <br /> <code class="highlighter-rouge">bin/kafka-server-start.sh config/server.properties</code> <br /> When the Kafka server is up and running, it prints a message similar to the following: <br /> <code class="highlighter-rouge">INFO [KafkaServer id=0] started</code></li>
  <li>Now create a topic called <code class="highlighter-rouge">TSOURCE</code>: <br /> <code class="highlighter-rouge">bin/kafka-topics.sh --zookeeper localhost:2181  --create --topic TSOURCE --partitions 1 --replication-factor 1</code></li>
  <li>To check what topics exist, use the following command: <br /> <code class="highlighter-rouge">bin/kafka-topics.sh --zookeeper localhost:2181 --describe</code></li>
</ol>

<p>You now have a basic Kafka cluster setup consisting of a single node with the following configuration:</p>
<ul>
  <li>Kafka bootstrap server: <code class="highlighter-rouge">localhost:9092</code></li>
  <li>ZooKeeper server: <code class="highlighter-rouge">localhost:2181</code></li>
  <li>Topic name: <code class="highlighter-rouge">TSOURCE</code></li>
</ul>

<p><strong>NOTE:</strong> This configuration of Kafka writes its data in <code class="highlighter-rouge">/tmp/kafka-logs</code>, while ZooKeeper uses <code class="highlighter-rouge">/tmp/zookeeper</code>, and Kafka Connect uses <code class="highlighter-rouge">/tmp/connect.offsets</code>. To ensure these directories are not being used, clear them out before using Apache Kafka.</p>

<h2 id="configuring-the-connector">Configuring the connector</h2>

<p>The connector requires details to connect to IBM MQ and to your IBM Event Streams or Apache Kafka cluster.</p>

<p>To provide connection details for IBM MQ, use the sample connector properties file you downloaded (<code class="highlighter-rouge">mq-source.properties</code>). Create a copy of it and save it to the location where you have the connector JAR file.</p>

<p>The connector connects to IBM MQ using a client connection. You must provide the following connection information for your queue manager:</p>
<ul>
  <li>The name of the IBM MQ queue manager.</li>
  <li>The connection name (one or more host and port pairs).</li>
  <li>The channel name.</li>
  <li>The name of the source IBM MQ queue.</li>
  <li>The user name and password if the queue manager is configured to require them for client connections.</li>
  <li>The name of the target Kafka topic.</li>
</ul>

<p>For example, the following are required configuration details:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mq.queue.manager=MYQM
mq.connection.name.list=localhost(1414)
mq.channel.name=MYSVRCONN
mq.queue=MYQSOURCE
mq.user.name=alice
mq.password=passw0rd
topic=TSOURCE
</code></pre></div></div>

<p>See the sample properties file for a full list of properties you can configure, and also see the <a href="../mq-source-reference/">configuration reference</a>.</p>

<p>To provide the connection details for your Kafka cluster, the Kafka distribution includes a file called <code class="highlighter-rouge">connect-standalone.properties</code> that you can edit to provide the details. Specify the following connection information:</p>
<ul>
  <li>A list of one or more servers for bootstrapping connections.</li>
  <li>Whether the cluster requires connections to use SSL/TLS.</li>
  <li>Authentication credentials if the cluster requires clients to authenticate.</li>
</ul>

<p><strong>DRAFT COMMENT:</strong> <em>This is not entirely clear to me, is this accurate Andrew? Also, how do you do this: “You will also need to run the Kafka Connect worker.”</em></p>

<p><strong>Note:</strong> You can use an existing IBM MQ or Kafka installation, either locally or on the cloud. For performance reasons, it is recommended to run the Kafka Connect worker close to the queue manager to minimise the effect of network latency. For example, if you have a queue manager in your datacenter and Kafka in the cloud, it’s best to run the Kafka Connect worker in your datacenter. <br /> To use an existing queue manager, provide its configuration information in the connector properties file following the previous example.</p>

<p><strong>Tip:</strong> Alternatively, IBM Message Hub is a fully managed cloud deployment of Apache Kafka running in IBM Cloud. In this case, the cluster is running in IBM Cloud but you will still need to run the Kafka Connect worker. If the queue manager is also in the cloud, you could also run the worker in the cloud. If the network latency between the queue manager and Kafka is high, you should run the worker near the queue manager. For information about how to configure Kafka Connect to work with IBM Message Hub read <a href="https://console.bluemix.net/docs/services/MessageHub/messagehub113.html#kafka_connect">this</a>.</p>

<h2 id="running-the-connector">Running the connector</h2>

<ol>
  <li>Open a terminal window and change to the Kafka root directory. Start the connector worker as follows: <br /> <code class="highlighter-rouge">CLASSPATH=&lt;path-to-connector-root-directory&gt;/target/kafka-connect-mq-source-0.6-SNAPSHOT-jar-with-dependencies.jar bin/connect-standalone.sh config/connect-standalone.properties ~/mq-source.properties</code> <br /> <strong>DRAFT COMMENT:</strong> <em>If you download and thus do not need to build the JAR, would it still need to be in a /target directory?</em>
<br />
When the connector worker starts, the following message is displayed: <br /> <code class="highlighter-rouge">INFO Created connector mq-source</code> <br />
When the connector worker successfully connects to IBM MQ, the following message is displayed: <br />
<code class="highlighter-rouge">INFO Connection to MQ established</code></li>
  <li>Open another terminal window and use the Kafka console consumer command to start consuming messages from your topic, and print them to the console: <br /> <code class="highlighter-rouge">bin/kafka-console-consumer.sh --bootstrap-server localhost:9092 --topic TSOURCE</code></li>
  <li>To add messages to the IBM MQ queue, run the <code class="highlighter-rouge">amqsput</code> sample and type in some messages: <br /> <code class="highlighter-rouge">/opt/mqm/samp/bin/amqsput MYQSOURCE MYQM</code></li>
</ol>

<p>The messages are printed by the Kafka console consumer, and are transferred from the IBM MQ queue <code class="highlighter-rouge">MYQSOURCE</code> into the Kafka topic <code class="highlighter-rouge">TSOURCE</code> using the <code class="highlighter-rouge">MYQM</code> queue manager.</p>

<h2 id="stopping-apache-kafka">Stopping Apache Kafka</h2>

<p>When you completed testing the connector, stop Apache Kafka as follows:</p>

<ol>
  <li>Stop any Kafka Connect workers, console producers, and consumers that are running. <strong>DRAFT COMMENT:</strong> <em>Should we tell them how?</em></li>
  <li>Change to the Kafka root directory and stop Kafka: <br /> <code class="highlighter-rouge">bin/kafka-server-stop.sh</code></li>
  <li>Stop ZooKeeper: <br /> <code class="highlighter-rouge">bin/zookeeper-server-stop.sh</code></li>
</ol>

        
      </section>

      <footer class="page__meta">
        
        


        
          <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2018-07-19">July 19, 2018</time></p>
        
      </footer>

      

      
  <nav class="pagination">
    
      <a href="/mhub/qp-docs/docs/replication/health/" class="pagination--pager" title="Monitoring and managing geo-replication
">Previous</a>
    
    
      <a href="/mhub/qp-docs/docs/connecting/mq-source-reference/" class="pagination--pager" title="Reference for IBM MQ source connector
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
</div>
      <!-- <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <div align="center" style="margin: 1em 0;">
        <ins class="adsbygoogle"
             style="display:block; border-bottom: initial;"
             data-ad-client="ca-pub-7328585512091257"
             data-ad-slot="3049671934"
             data-ad-format="auto"></ins>
        </div>
        <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
      </script> -->
    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><input type="text" id="search" class="search-input" tabindex="-1" placeholder="Enter your search term..." />
    <div id="results" class="results"></div></div>
      </div>
    

    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        
<div class="page__footer-copyright"><a href="https://www.ibm.com/privacy/us/en/" rel="nofollow" target="_blank">Privacy Policy</a>  &nbsp;© Copyright IBM Corp. 2018</br>
  Released under the <a href="https://www.apache.org/licenses/LICENSE-2.0" rel="nofollow" target="_blank">Apache License v2.0</a></div>

      </footer>
    </div>

    
  <script src="/mhub/qp-docs/assets/js/main.min.js"></script>
  <script src="https://use.fontawesome.com/releases/v5.2.0/js/all.js"></script>




<script src="/mhub/qp-docs/assets/js/lunr/lunr.min.js"></script>
<script src="/mhub/qp-docs/assets/js/lunr/lunr-store.js"></script>
<script src="/mhub/qp-docs/assets/js/lunr/lunr-en.js"></script>





  </body>
</html>
